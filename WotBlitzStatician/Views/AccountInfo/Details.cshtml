@model WotBlitzStatician.ViewModel.AccountInfoViewModel
@{
	ViewData["NickName"] = Model.NickName;
	ViewData["AccountId"] = Model.AccountId;
	var clanInfo = Model.AccountClanInfo == null ? "" : $"В клане [{Model.AccountClanInfo.ClanTag}] '{Model.AccountClanInfo.ClanName}' c {Model.AccountClanInfo.JoinedAt}";
}

<h2>@Model.NickName</h2>
<br/>
<p>@clanInfo</p>
<p>Последний бой @Html.DisplayFor(m => m.LastBattleTime, null)</p>
<br/>
<table class="table">
	<tr>
		<td>
			<table class="table">
				<tr>
					<td>
						Статистика обновлена
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PresentUpdatedAt, null) <small>@Html.DisplayFor(m => m.AccountInfoDelta.UpdatedAtDelta, null)</small>
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PastUpdatedAt, null)
					</td>
				</tr>
				<tr>
					<td>
						Боёв
					</td>
					<td>
						@Html.DisplayFor(m => m.Battles, null) <small>@Html.DisplayFor(m => m.AccountInfoDelta.BattlesDelta, null)</small>
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PastBattles, null)
					</td>
				</tr>
				<tr>
					<td>
						Побед
					</td>
					<td>
						@Html.DisplayFor(m => m.Wins, null) <small>@Html.DisplayFor(m => m.AccountInfoDelta.WinsDelta, null) </small>
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PastWins, null)
					</td>
				</tr>
				<tr>
					<td>
						Winrate
					</td>
					<td>
						<b id="winrate">@Html.DisplayFor(m => m.Winrate, null)% (@Html.DisplayFor(m => m.WinrateGrade, null))</b> <small>@Html.DisplayFor(m => m.AccountInfoDelta.WinrateDelta, null) </small>
					</td>
					<td>
						<b>@Html.DisplayFor(m => m.AccountInfoDelta.PastWinrate, null)%</b>
					</td>
				</tr>
				<tr>
					<td>
						Wn7
					</td>
					<td>
						<b id="wn7">
							@Html.DisplayFor(m => m.Wn7, null) (@Html.DisplayFor(m => m.Wn7Grade, null))
						</b> <small>@Html.DisplayFor(m => m.AccountInfoDelta.Wn7Delta, null)</small>
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PastWn7, null)
					</td>
				</tr>
				<tr>
					<td>
						Средний урон
					</td>
					<td>
						@Html.DisplayFor(m => m.AvgDamage, null) <small>@Html.DisplayFor(m => m.AccountInfoDelta.AvgDamageDelta, null) </small>
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PastAvgDamage, null)
					</td>
				</tr>
				<tr>
					<td>
						Средний опыт
					</td>
					<td>
						@Html.DisplayFor(m => m.AvgXp, null) <small>@Html.DisplayFor(m => m.AccountInfoDelta.AvgXpDelta, null) </small>
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PastAvgXp, null)
					</td>
				</tr>
				<tr>
					<td>
						Танкоуровень
					</td>
					<td>
						@Html.DisplayFor(m => m.AvgTier, null) <small>@Html.DisplayFor(m => m.AccountInfoDelta.AvgTierDelta, null) </small>
					</td>
					<td>
						@Html.DisplayFor(m => m.AccountInfoDelta.PastAvgTier, null)
					</td>
				</tr>
			</table>
		</td>
		<td>
			<table class="table">
				@foreach (var tankId in Model.LastSessionTanks)
				{
					<tr><td>
						@await Component.InvokeAsync("TankDelta", new { tankId = tankId, accountId = Model.AccountId, dateFrom = Model.PreLastUpdatedDate})
					</td></tr>
				}
			</table>
		</td>
	</tr>
</table>
	<script>
	var wn7Grade = "@Model.Wn7Grade.ToString()";
	var winrateGrade = "@Model.WinrateGrade.ToString()";
		</script>
